<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>(function (){

  var start_date = new Date().getTime(),
      done_date = 0,
      time_taken = 0;


  /**
   *
   * App namespacing
   *
   */ 
  var app = {};
  process.app = app;


  /**
   *
   * App modules
   * 
   */
  app.modules = {
    fs: require('fs'),
    qs: require('querystring'),
    http: require('http'),
    cls: require('opensoars_cls'),
    Ezlog: require('ezlog')
  };


  /**
   *
   * Get/check/fix user definable parameters
   *
   */
  app.params = require('./params.json');

  if(!app.params.dl_dir)
    throw 'No dl_dir specified in params.json';
  if(!app.params.app_port)
    throw 'No app_port specified in params.json';
  if(!app.params.http_api_port)
    throw 'No http_api_port specified in params.json';
  if(!app.params.ws_port)
    throw 'No ws_port specified in params.json';

  if(!app.params.max_retries)
    app.params.max_retries = 10;
  if(!app.params.log &amp;&amp; app.params.log !== false)
    app.params.log = true;


  /**
   *
   * App variables
   * 
   */
  app.api = {
    http: {
      url: '/api',
      url_re: /^\/api\/?/
    }
  };

  app.dump = {};


  /**
   *
   * Setup all loggers
   *
   */

  //
  // FIX THE LOGGIN SHIT
  //
  process.logs = require('./lib/loggers');


  /**
   *
   * App libraries
   *
   */
  app.downloads = require('./lib/collections/downloads.js');

  app.http = require('./lib/servers/http/');
  app.ws = require('./lib/servers/ws');

  app.Dump = require('./lib/dump');


  /**
   *
   * Initialize
   *
   */

  app.dump = new app.Dump({
    dir: __dirname + '/dump/'
  });


  app.http.router.get('/downloads', function (req, res){
    console.log('keke');
  });

  app.http.router.get('/downloads/:id', function (req, res){
    console.log('keke ID');
  });


  // Start listening for HTTP requests
  app.http.server = app.http.create(app.http.router.listener)
    .listen(app.params.http_api_port);

  if(app.params.log)
    app.log('HTTP server listening at port: ' + app.params.http_api_port);


  // Startup info
  done_date = new Date().getTime();
  app.time_taken = done_date - start_date;

  if(app.params.log)
    app.log('Ready, launched in ' +  app.time_taken + ' ms');

}());


</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module.exports-Decipherer.html">Decipherer</a></li><li><a href="module.html#.exports#~Download">Download</a></li></ul><h3>Namespaces</h3><ul><li><a href="module.exports-solutions.html">solutions</a></li><li><a href="Router.html">Router</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.1</a> on Mon Jun 22 2015 16:45:35 GMT+0200 (W. Europe Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
